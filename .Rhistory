sites_abb <- list(BCI  = "BCNM",
HKK = "HKK",
NewMexico = "LT",
CedarBreaks = "CB",
SCBI = "SCBI",
LillyDickey = "LDW",
HarvardForest = "HF",
# Nebraska = "NE",
Niobara = "NIO",
# Hansley = "Hansley",
Zofin = "ZOF",
ScottyCreek = "SC")
# load data ####
species_list <- read.csv("https://raw.githubusercontent.com/EcoClimLab/ForestGEO_dendro/master/data/species%20list/sitespecies.csv?token=AEWDCIJDPYS6SYM54V4UJRTBGIM7W")
bark_allo <- read.csv("https://raw.githubusercontent.com/EcoClimLab/ForestGEO_dendro/master/data_processed/dbh_to_bark_allometries_table.csv?token=AEWDCIPEHDR4WSBYT55AJD3BGITPC")
load("results/log_core_measurement/BCI_all_env.RData")
# prepare species list ####
species_summary <- data.frame(species.code = species_list$species_code,
family = species_list$family,
latin.name = species_list$latin_name,
accepted.name =species_list$accepted_latin_name_with_authority,
'sites.sampled' = NA,
leaf.type = species_list$leaf_type,
leaf.phenology = species_list$leaf_pheno,
light.requirements = species_list$light_requirements,
bark.allometry = NA
)
## remove duplicates
species_summary <- species_summary[!duplicated(species_summary),]
## add list of sites
species_sites <- data.frame(species_code = unlist(sapply(all_Biol, function(x) as.character(unique(x$species_code)))))
species_sites <- species_sites[-grep("Hansley", row.names(species_sites)),,drop=FALSE] # remove Hansley if is there
species_sites$site <- unlist(sites_abb[gsub("\\d", "", row.names(species_sites))])
species_summary$sites.sampled <- tapply(species_sites$site, species_sites$species_code, paste0, collapse = ", ")[as.character(species_summary$species.code)]
## add bark allomatries
species_summary$bark.allometry <- tapply(ifelse(is.na(species_list$bark_species) | species_list$bark_species == "", "neglected", species_list$bark_latin), species_list$species_code, function(x) paste(unique(x), collapse = ", "))[as.character(species_summary$species.code)] #tapply(paste0(ifelse(is.na(species_list$bark_species) | species_list$bark_species == "", "neglected", paste(species_list$bark_latin, "in ")), species_list$bark_site), species_list$species_code, function(x) paste(unique(x), collapse = ", "))[as.character(species_summary$species.code)]
species_summary$bark.allometry <- gsub(", neglected.*$", "", species_summary$bark.allometry ) # remove repetition of neglected
species_summary$bark.allometry <- gsub(" ,", ",", species_summary$bark.allometry ) # remove space before comma
unique(cbind(species_summary$bark.allometry,ifelse(species_summary$bark.allometry %in% "neglected", "neglected", match(species_summary$bark.allometry, bark_allo$species)))[is.na(ifelse(species_summary$bark.allometry %in% "neglected", "neglected", match(species_summary$bark.allometry, bark_allo$species)))])
## order by species code
species_summary <- species_summary[order(species_summary$latin.name), ]
## remove species that are not sampled in any site
species_summary <- species_summary[!is.na(species_summary$sites.sampled), ]
# change needleleaf to conifer
species_summary$leaf.type <- gsub("needleleaf", "conifer", species_summary$leaf.type)
species_summary
bark
unique(cbind(species_summary$bark.allometry,ifelse(species_summary$bark.allometry %in% "neglected", "neglected", match(species_summary$bark.allometry, bark_allo$species)))[is.na(ifelse(species_summary$bark.allometry %in% "neglected", "neglected", match(species_summary$bark.allometry, bark_allo$species)))])
bark_allo$species
bark.allometry
species_summary$bark.allometry
# --- create tables for manuscript --- #
# clear environment ####
rm(list = ls())
# load libraries ####
library(tidyverse)
# prepare sites abbrevaiations ####
# give site abbrevationtion in paper
sites_abb <- list(BCI  = "BCNM",
HKK = "HKK",
NewMexico = "LT",
CedarBreaks = "CB",
SCBI = "SCBI",
LillyDickey = "LDW",
HarvardForest = "HF",
# Nebraska = "NE",
Niobara = "NIO",
# Hansley = "Hansley",
Zofin = "ZOF",
ScottyCreek = "SC")
# load data ####
species_list <- read.csv("https://raw.githubusercontent.com/EcoClimLab/ForestGEO_dendro/master/data/species%20list/sitespecies.csv?token=AEWDCIJDPYS6SYM54V4UJRTBGIM7W")
bark_allo <- read.csv("https://raw.githubusercontent.com/EcoClimLab/ForestGEO_dendro/master/data_processed/dbh_to_bark_allometries_table.csv?token=AEWDCIPEHDR4WSBYT55AJD3BGITPC")
load("results/log_core_measurement/BCI_all_env.RData")
# prepare species list ####
species_summary <- data.frame(species.code = species_list$species_code,
family = species_list$family,
latin.name = species_list$latin_name,
accepted.name =species_list$accepted_latin_name_with_authority,
'sites.sampled' = NA,
leaf.type = species_list$leaf_type,
leaf.phenology = species_list$leaf_pheno,
light.requirements = species_list$light_requirements,
bark.allometry = NA
)
## remove duplicates
species_summary <- species_summary[!duplicated(species_summary),]
## add list of sites
species_sites <- data.frame(species_code = unlist(sapply(all_Biol, function(x) as.character(unique(x$species_code)))))
species_sites <- species_sites[-grep("Hansley", row.names(species_sites)),,drop=FALSE] # remove Hansley if is there
species_sites$site <- unlist(sites_abb[gsub("\\d", "", row.names(species_sites))])
species_summary$sites.sampled <- tapply(species_sites$site, species_sites$species_code, paste0, collapse = ", ")[as.character(species_summary$species.code)]
## add bark allomatries
species_summary$bark.allometry <- tapply(ifelse(is.na(species_list$bark_species) | species_list$bark_species == "", "neglected", species_list$bark_latin), species_list$species_code, function(x) paste(unique(x), collapse = ", "))[as.character(species_summary$species.code)] #tapply(paste0(ifelse(is.na(species_list$bark_species) | species_list$bark_species == "", "neglected", paste(species_list$bark_latin, "in ")), species_list$bark_site), species_list$species_code, function(x) paste(unique(x), collapse = ", "))[as.character(species_summary$species.code)]
species_summary$bark.allometry <- gsub(", neglected.*$", "", species_summary$bark.allometry ) # remove repetition of neglected
species_summary$bark.allometry <- gsub(" ,", ",", species_summary$bark.allometry ) # remove space before comma
unique(cbind(species_summary$bark.allometry,ifelse(species_summary$bark.allometry %in% "neglected", "neglected", match(species_summary$bark.allometry, bark_allo$species)))[is.na(ifelse(species_summary$bark.allometry %in% "neglected", "neglected", match(species_summary$bark.allometry, bark_allo$species)))])
species_summary$bark.allometry
bark_allo$species
# --- create tables for manuscript --- #
# clear environment ####
rm(list = ls())
# load libraries ####
library(tidyverse)
# prepare sites abbrevaiations ####
# give site abbrevationtion in paper
sites_abb <- list(BCI  = "BCNM",
HKK = "HKK",
NewMexico = "LT",
CedarBreaks = "CB",
SCBI = "SCBI",
LillyDickey = "LDW",
HarvardForest = "HF",
# Nebraska = "NE",
Niobara = "NIO",
# Hansley = "Hansley",
Zofin = "ZOF",
ScottyCreek = "SC")
# load data ####
species_list <- read.csv("https://raw.githubusercontent.com/EcoClimLab/ForestGEO_dendro/master/data/species%20list/sitespecies.csv?token=AEWDCIJDPYS6SYM54V4UJRTBGIM7W")
bark_allo <- read.csv("https://raw.githubusercontent.com/EcoClimLab/ForestGEO_dendro/master/data_processed/dbh_to_bark_allometries_table.csv?token=AEWDCIPEHDR4WSBYT55AJD3BGITPC")
load("results/log_core_measurement/BCI_all_env.RData")
# prepare species list ####
species_summary <- data.frame(species.code = species_list$species_code,
family = species_list$family,
latin.name = species_list$latin_name,
accepted.name =species_list$accepted_latin_name_with_authority,
'sites.sampled' = NA,
leaf.type = species_list$leaf_type,
leaf.phenology = species_list$leaf_pheno,
light.requirements = species_list$light_requirements,
bark.allometry = NA
)
## remove duplicates
species_summary <- species_summary[!duplicated(species_summary),]
## add list of sites
species_sites <- data.frame(species_code = unlist(sapply(all_Biol, function(x) as.character(unique(x$species_code)))))
species_sites <- species_sites[-grep("Hansley", row.names(species_sites)),,drop=FALSE] # remove Hansley if is there
species_sites$site <- unlist(sites_abb[gsub("\\d", "", row.names(species_sites))])
species_summary$sites.sampled <- tapply(species_sites$site, species_sites$species_code, paste0, collapse = ", ")[as.character(species_summary$species.code)]
## add bark allomatries
species_summary$bark.allometry <- tapply(ifelse(is.na(species_list$bark_species) | species_list$bark_species == "", "neglected", species_list$bark_latin), species_list$species_code, function(x) paste(unique(x), collapse = ", "))[as.character(species_summary$species.code)] #tapply(paste0(ifelse(is.na(species_list$bark_species) | species_list$bark_species == "", "neglected", paste(species_list$bark_latin, "in ")), species_list$bark_site), species_list$species_code, function(x) paste(unique(x), collapse = ", "))[as.character(species_summary$species.code)]
species_summary$bark.allometry <- gsub(", neglected.*$", "", species_summary$bark.allometry ) # remove repetition of neglected
species_summary$bark.allometry <- gsub(" ,", ",", species_summary$bark.allometry ) # remove space before comma
bark_allo$species
# --- create tables for manuscript --- #
# clear environment ####
rm(list = ls())
# load libraries ####
library(tidyverse)
# prepare sites abbrevaiations ####
# give site abbrevationtion in paper
sites_abb <- list(BCI  = "BCNM",
HKK = "HKK",
NewMexico = "LT",
CedarBreaks = "CB",
SCBI = "SCBI",
LillyDickey = "LDW",
HarvardForest = "HF",
# Nebraska = "NE",
Niobara = "NIO",
# Hansley = "Hansley",
Zofin = "ZOF",
ScottyCreek = "SC")
# load data ####
species_list <- read.csv("https://raw.githubusercontent.com/EcoClimLab/ForestGEO_dendro/master/data/species%20list/sitespecies.csv?token=AEWDCIJDPYS6SYM54V4UJRTBGIM7W")
bark_allo <- read.csv("https://raw.githubusercontent.com/EcoClimLab/ForestGEO_dendro/master/data_processed/dbh_to_bark_allometries_table.csv?token=AEWDCIPEHDR4WSBYT55AJD3BGITPC")
load("results/log_core_measurement/BCI_all_env.RData")
# prepare species list ####
species_summary <- data.frame(species.code = species_list$species_code,
family = species_list$family,
latin.name = species_list$latin_name,
accepted.name =species_list$accepted_latin_name_with_authority,
'sites.sampled' = NA,
leaf.type = species_list$leaf_type,
leaf.phenology = species_list$leaf_pheno,
light.requirements = species_list$light_requirements,
bark.allometry = NA
)
## remove duplicates
species_summary <- species_summary[!duplicated(species_summary),]
## add list of sites
species_sites <- data.frame(species_code = unlist(sapply(all_Biol, function(x) as.character(unique(x$species_code)))))
species_sites <- species_sites[-grep("Hansley", row.names(species_sites)),,drop=FALSE] # remove Hansley if is there
species_sites$site <- unlist(sites_abb[gsub("\\d", "", row.names(species_sites))])
species_summary$sites.sampled <- tapply(species_sites$site, species_sites$species_code, paste0, collapse = ", ")[as.character(species_summary$species.code)]
## add bark allomatries
species_summary$bark.allometry <- tapply(ifelse(is.na(species_list$bark_species) | species_list$bark_species == "", "neglected", species_list$bark_latin), species_list$species_code, function(x) paste(unique(x), collapse = ", "))[as.character(species_summary$species.code)] #tapply(paste0(ifelse(is.na(species_list$bark_species) | species_list$bark_species == "", "neglected", paste(species_list$bark_latin, "in ")), species_list$bark_site), species_list$species_code, function(x) paste(unique(x), collapse = ", "))[as.character(species_summary$species.code)]
species_summary$bark.allometry <- gsub(", neglected.*$", "", species_summary$bark.allometry ) # remove repetition of neglected
species_summary$bark.allometry <- gsub(" ,", ",", species_summary$bark.allometry ) # remove space before comma
bark_allo$species
bark_allo <- read.csv("https://raw.githubusercontent.com/EcoClimLab/ForestGEO_dendro/master/data_processed/dbh_to_bark_allometries_table.csv?token=AEWDCIPEHDR4WSBYT55AJD3BGITPC")
bark_allo$species
bark_allo <- read.csv("https://raw.githubusercontent.com/EcoClimLab/ForestGEO_dendro/master/data_processed/dbh_to_bark_allometries_table.csv?token=AEWDCIPEHDR4WSBYT55AJD3BGITPC")
View(bark_allo)
bark_allo <- read.csv("https://raw.githubusercontent.com/EcoClimLab/ForestGEO_dendro/master/data_processed/dbh_to_bark_allometries_table.csv?token=AEWDCIOOA5YVV4GBBP5NYK3BGI7S2")
bark_allo$species
unique(cbind(species_summary$bark.allometry,ifelse(species_summary$bark.allometry %in% "neglected", "neglected", match(species_summary$bark.allometry, bark_allo$species)))[is.na(ifelse(species_summary$bark.allometry %in% "neglected", "neglected", match(species_summary$bark.allometry, bark_allo$species)))])
## change bark allometry to allometry ID
ifelse(species_summary$bark.allometry %in% "neglected", "neglected", bark_allo$ID[match(species_summary$bark.allometry, bark_allo$species)])
## change bark allometry to allometry ID
species_summary$bark.allometry <- ifelse(species_summary$bark.allometry %in% "neglected", "neglected", bark_allo$ID[match(species_summary$bark.allometry, bark_allo$species)])
# --- create tables for manuscript --- #
# clear environment ####
rm(list = ls())
# load libraries ####
library(tidyverse)
# prepare sites abbrevaiations ####
# give site abbrevationtion in paper
sites_abb <- list(BCI  = "BCNM",
HKK = "HKK",
NewMexico = "LT",
CedarBreaks = "CB",
SCBI = "SCBI",
LillyDickey = "LDW",
HarvardForest = "HF",
# Nebraska = "NE",
Niobara = "NIO",
# Hansley = "Hansley",
Zofin = "ZOF",
ScottyCreek = "SC")
# load data ####
species_list <- read.csv("https://raw.githubusercontent.com/EcoClimLab/ForestGEO_dendro/master/data/species%20list/sitespecies.csv?token=AEWDCIJDPYS6SYM54V4UJRTBGIM7W")
bark_allo <- read.csv("https://raw.githubusercontent.com/EcoClimLab/ForestGEO_dendro/master/data_processed/dbh_to_bark_allometries_table.csv?token=AEWDCIOOA5YVV4GBBP5NYK3BGI7S2")
load("results/log_core_measurement/BCI_all_env.RData")
# prepare species list ####
species_summary <- data.frame(species.code = species_list$species_code,
family = species_list$family,
# latin.name = species_list$latin_name,
accepted.name =species_list$accepted_latin_name_with_authority,
'sites.sampled' = NA,
leaf.type = species_list$leaf_type,
leaf.phenology = species_list$leaf_pheno,
light.requirements = species_list$light_requirements,
bark.allometry = NA
)
## remove duplicates
species_summary <- species_summary[!duplicated(species_summary),]
## add list of sites
species_sites <- data.frame(species_code = unlist(sapply(all_Biol, function(x) as.character(unique(x$species_code)))))
species_sites <- species_sites[-grep("Hansley", row.names(species_sites)),,drop=FALSE] # remove Hansley if is there
species_sites$site <- unlist(sites_abb[gsub("\\d", "", row.names(species_sites))])
species_summary$sites.sampled <- tapply(species_sites$site, species_sites$species_code, paste0, collapse = ", ")[as.character(species_summary$species.code)]
## add bark allomatries
species_summary$bark.allometry <- tapply(ifelse(is.na(species_list$bark_species) | species_list$bark_species == "", "neglected", species_list$bark_latin), species_list$species_code, function(x) paste(unique(x), collapse = ", "))[as.character(species_summary$species.code)] #tapply(paste0(ifelse(is.na(species_list$bark_species) | species_list$bark_species == "", "neglected", paste(species_list$bark_latin, "in ")), species_list$bark_site), species_list$species_code, function(x) paste(unique(x), collapse = ", "))[as.character(species_summary$species.code)]
species_summary$bark.allometry <- gsub(", neglected.*$", "", species_summary$bark.allometry ) # remove repetition of neglected
species_summary$bark.allometry <- gsub(" ,", ",", species_summary$bark.allometry ) # remove space before comma
## change bark allometry to allometry ID
species_summary$bark.allometry <- ifelse(species_summary$bark.allometry %in% "neglected", "neglected", bark_allo$ID[match(species_summary$bark.allometry, bark_allo$species)])
## order by latin name
species_summary <- species_summary[order(species_summary$accepted.name), ]
## remove species that are not sampled in any site
species_summary <- species_summary[!is.na(species_summary$sites.sampled), ]
# change needleleaf to conifer
species_summary$leaf.type <- gsub("needleleaf", "conifer", species_summary$leaf.type)
## italicize latin names
# species_summary$latin.name  <- paste0("$",species_summary$latin.name ,  "$")
species_summary$accepted.name[!species_summary$accepted.name %in% ""] <- sapply(strsplit(species_summary$accepted.name[!species_summary$accepted.name %in% ""] , " "), function(x) {
x[c(1,2)] <- paste0("$", x[c(1,2)] ,  "$")
x <-  paste(x , collapse = " ")
return(x)
})
## replace underscores by spaces
names(species_summary) <- gsub("\\.|_", " ", names(species_summary))
## save
write.csv(species_summary, "doc/manuscript/tables_figures/species.csv", row.names = F)
bark_allo$species
# --- create tables for manuscript --- #
# clear environment ####
rm(list = ls())
# load libraries ####
library(tidyverse)
# prepare sites abbrevaiations ####
# give site abbrevationtion in paper
sites_abb <- list(BCI  = "BCNM",
HKK = "HKK",
NewMexico = "LT",
CedarBreaks = "CB",
SCBI = "SCBI",
LillyDickey = "LDW",
HarvardForest = "HF",
# Nebraska = "NE",
Niobara = "NIO",
# Hansley = "Hansley",
Zofin = "ZOF",
ScottyCreek = "SC")
# load data ####
species_list <- read.csv("https://raw.githubusercontent.com/EcoClimLab/ForestGEO_dendro/master/data/species%20list/sitespecies.csv?token=AEWDCIJDPYS6SYM54V4UJRTBGIM7W")
bark_allo <- read.csv("https://raw.githubusercontent.com/EcoClimLab/ForestGEO_dendro/master/data_processed/dbh_to_bark_allometries_table.csv?token=AEWDCIOW4CICEKPFXKFR3IDBGJAVA")
load("results/log_core_measurement/BCI_all_env.RData")
# prepare species list ####
species_summary <- data.frame(species.code = species_list$species_code,
family = species_list$family,
# latin.name = species_list$latin_name,
accepted.name =species_list$accepted_latin_name_with_authority,
'sites.sampled' = NA,
leaf.type = species_list$leaf_type,
leaf.phenology = species_list$leaf_pheno,
light.requirements = species_list$light_requirements,
bark.allometry = NA
)
## remove duplicates
species_summary <- species_summary[!duplicated(species_summary),]
## add list of sites
species_sites <- data.frame(species_code = unlist(sapply(all_Biol, function(x) as.character(unique(x$species_code)))))
species_sites <- species_sites[-grep("Hansley", row.names(species_sites)),,drop=FALSE] # remove Hansley if is there
species_sites$site <- unlist(sites_abb[gsub("\\d", "", row.names(species_sites))])
species_summary$sites.sampled <- tapply(species_sites$site, species_sites$species_code, paste0, collapse = ", ")[as.character(species_summary$species.code)]
## add bark allomatries
species_summary$bark.allometry <- tapply(ifelse(is.na(species_list$bark_species) | species_list$bark_species == "", "neglected", species_list$bark_latin), species_list$species_code, function(x) paste(unique(x), collapse = ", "))[as.character(species_summary$species.code)] #tapply(paste0(ifelse(is.na(species_list$bark_species) | species_list$bark_species == "", "neglected", paste(species_list$bark_latin, "in ")), species_list$bark_site), species_list$species_code, function(x) paste(unique(x), collapse = ", "))[as.character(species_summary$species.code)]
species_summary$bark.allometry <- gsub(", neglected.*$", "", species_summary$bark.allometry ) # remove repetition of neglected
species_summary$bark.allometry <- gsub(" ,", ",", species_summary$bark.allometry ) # remove space before comma
bark_allo$species
species_summary$bark.allometry
ifelse(species_summary$bark.allometry %in% "neglected", "neglected", bark_allo$ID[match(paste0("$", species_summary$bark.allometry, "$"), bark_allo$species)])
## change bark allometry to allometry ID
species_summary$bark.allometry <- ifelse(species_summary$bark.allometry %in% "neglected", "neglected", bark_allo$ID[match(paste0("$", species_summary$bark.allometry, "$"), bark_allo$species)])
# --- create tables for manuscript --- #
# clear environment ####
rm(list = ls())
# load libraries ####
library(tidyverse)
# prepare sites abbrevaiations ####
# give site abbrevationtion in paper
sites_abb <- list(BCI  = "BCNM",
HKK = "HKK",
NewMexico = "LT",
CedarBreaks = "CB",
SCBI = "SCBI",
LillyDickey = "LDW",
HarvardForest = "HF",
# Nebraska = "NE",
Niobara = "NIO",
# Hansley = "Hansley",
Zofin = "ZOF",
ScottyCreek = "SC")
# load data ####
species_list <- read.csv("https://raw.githubusercontent.com/EcoClimLab/ForestGEO_dendro/master/data/species%20list/sitespecies.csv?token=AEWDCIJDPYS6SYM54V4UJRTBGIM7W")
bark_allo <- read.csv("https://raw.githubusercontent.com/EcoClimLab/ForestGEO_dendro/master/data_processed/dbh_to_bark_allometries_table.csv?token=AEWDCIOW4CICEKPFXKFR3IDBGJAVA")
load("results/log_core_measurement/BCI_all_env.RData")
# prepare species list ####
species_summary <- data.frame(species.code = species_list$species_code,
family = species_list$family,
# latin.name = species_list$latin_name,
accepted.name =species_list$accepted_latin_name_with_authority,
'sites.sampled' = NA,
leaf.type = species_list$leaf_type,
leaf.phenology = species_list$leaf_pheno,
light.requirements = species_list$light_requirements,
bark.allometry = NA
)
## remove duplicates
species_summary <- species_summary[!duplicated(species_summary),]
## add list of sites
species_sites <- data.frame(species_code = unlist(sapply(all_Biol, function(x) as.character(unique(x$species_code)))))
species_sites <- species_sites[-grep("Hansley", row.names(species_sites)),,drop=FALSE] # remove Hansley if is there
species_sites$site <- unlist(sites_abb[gsub("\\d", "", row.names(species_sites))])
species_summary$sites.sampled <- tapply(species_sites$site, species_sites$species_code, paste0, collapse = ", ")[as.character(species_summary$species.code)]
## add bark allomatries
species_summary$bark.allometry <- tapply(ifelse(is.na(species_list$bark_species) | species_list$bark_species == "", "neglected", species_list$bark_latin), species_list$species_code, function(x) paste(unique(x), collapse = ", "))[as.character(species_summary$species.code)] #tapply(paste0(ifelse(is.na(species_list$bark_species) | species_list$bark_species == "", "neglected", paste(species_list$bark_latin, "in ")), species_list$bark_site), species_list$species_code, function(x) paste(unique(x), collapse = ", "))[as.character(species_summary$species.code)]
species_summary$bark.allometry <- gsub(", neglected.*$", "", species_summary$bark.allometry ) # remove repetition of neglected
species_summary$bark.allometry <- gsub(" ,", ",", species_summary$bark.allometry ) # remove space before comma♦
## change bark allometry to allometry ID
species_summary$bark.allometry <- ifelse(species_summary$bark.allometry %in% "neglected", "neglected", bark_allo$ID[match(paste0("$", species_summary$bark.allometry, "$"), bark_allo$species)])
## order by latin name
species_summary <- species_summary[order(species_summary$accepted.name), ]
## remove species that are not sampled in any site
species_summary <- species_summary[!is.na(species_summary$sites.sampled), ]
# change needleleaf to conifer
species_summary$leaf.type <- gsub("needleleaf", "conifer", species_summary$leaf.type)
## italicize latin names
# species_summary$latin.name  <- paste0("$",species_summary$latin.name ,  "$")
species_summary$accepted.name[!species_summary$accepted.name %in% ""] <- sapply(strsplit(species_summary$accepted.name[!species_summary$accepted.name %in% ""] , " "), function(x) {
x[c(1,2)] <- paste0("$", x[c(1,2)] ,  "$")
x <-  paste(x , collapse = " ")
return(x)
})
## replace underscores by spaces
names(species_summary) <- gsub("\\.|_", " ", names(species_summary))
## save
write.csv(species_summary, "doc/manuscript/tables_figures/species.csv", row.names = F)
# --- create tables for manuscript --- #
# clear environment ####
rm(list = ls())
# load libraries ####
library(tidyverse)
# prepare sites abbrevaiations ####
# give site abbrevationtion in paper
sites_abb <- list(BCI  = "BCNM",
HKK = "HKK",
NewMexico = "LT",
CedarBreaks = "CB",
SCBI = "SCBI",
LillyDickey = "LDW",
HarvardForest = "HF",
# Nebraska = "NE",
Niobara = "NIO",
# Hansley = "Hansley",
Zofin = "ZOF",
ScottyCreek = "SC")
# load data ####
species_list <- read.csv("https://raw.githubusercontent.com/EcoClimLab/ForestGEO_dendro/master/data/species%20list/sitespecies.csv?token=AEWDCIJDPYS6SYM54V4UJRTBGIM7W")
bark_allo <- read.csv("https://raw.githubusercontent.com/EcoClimLab/ForestGEO_dendro/master/data_processed/dbh_to_bark_allometries_table.csv?token=AEWDCIOW4CICEKPFXKFR3IDBGJAVA")
load("results/log_core_measurement/BCI_all_env.RData")
# prepare species list ####
species_summary <- data.frame(species.code = species_list$species_code,
family = species_list$family,
latin.name = species_list$latin_name,
accepted.name =species_list$accepted_latin_name_with_authority,
'sites.sampled' = NA,
leaf.type = species_list$leaf_type,
leaf.phenology = species_list$leaf_pheno,
light.requirements = species_list$light_requirements,
bark.allometry = NA
)
## remove duplicates
species_summary <- species_summary[!duplicated(species_summary),]
## add list of sites
species_sites <- data.frame(species_code = unlist(sapply(all_Biol, function(x) as.character(unique(x$species_code)))))
species_sites <- species_sites[-grep("Hansley", row.names(species_sites)),,drop=FALSE] # remove Hansley if is there
species_sites$site <- unlist(sites_abb[gsub("\\d", "", row.names(species_sites))])
species_summary$sites.sampled <- tapply(species_sites$site, species_sites$species_code, paste0, collapse = ", ")[as.character(species_summary$species.code)]
## add bark allomatries
species_summary$bark.allometry <- tapply(ifelse(is.na(species_list$bark_species) | species_list$bark_species == "", "neglected", species_list$bark_latin), species_list$species_code, function(x) paste(unique(x), collapse = ", "))[as.character(species_summary$species.code)] #tapply(paste0(ifelse(is.na(species_list$bark_species) | species_list$bark_species == "", "neglected", paste(species_list$bark_latin, "in ")), species_list$bark_site), species_list$species_code, function(x) paste(unique(x), collapse = ", "))[as.character(species_summary$species.code)]
species_summary$bark.allometry <- gsub(", neglected.*$", "", species_summary$bark.allometry ) # remove repetition of neglected
species_summary$bark.allometry <- gsub(" ,", ",", species_summary$bark.allometry ) # remove space before comma♦
## change bark allometry to allometry ID
species_summary$bark.allometry <- ifelse(species_summary$bark.allometry %in% "neglected", "neglected", bark_allo$ID[match(paste0("$", species_summary$bark.allometry, "$"), bark_allo$species)])
## order by latin name
species_summary <- species_summary[order(species_summary$accepted.name), ]
## remove species that are not sampled in any site
species_summary <- species_summary[!is.na(species_summary$sites.sampled), ]
# change needleleaf to conifer
species_summary$leaf.type <- gsub("needleleaf", "conifer", species_summary$leaf.type)
## italicize latin names
species_summary$latin.name  <- paste0("$",species_summary$latin.name ,  "$")
species_summary$accepted.name[!species_summary$accepted.name %in% ""] <- sapply(strsplit(species_summary$accepted.name[!species_summary$accepted.name %in% ""] , " "), function(x) {
x[c(1,2)] <- paste0("$", x[c(1,2)] ,  "$")
x <-  paste(x , collapse = " ")
return(x)
})
## replace underscores by spaces
names(species_summary) <- gsub("\\.|_", " ", names(species_summary))
## save
write.csv(species_summary, "doc/manuscript/tables_figures/species.csv", row.names = F)
# --- create tables for manuscript --- #
# clear environment ####
rm(list = ls())
# load libraries ####
library(tidyverse)
# prepare sites abbrevaiations ####
# give site abbrevationtion in paper
sites_abb <- list(BCI  = "BCNM",
HKK = "HKK",
NewMexico = "LT",
CedarBreaks = "CB",
SCBI = "SCBI",
LillyDickey = "LDW",
HarvardForest = "HF",
# Nebraska = "NE",
Niobara = "NIO",
# Hansley = "Hansley",
Zofin = "ZOF",
ScottyCreek = "SC")
# load data ####
species_list <- read.csv("https://raw.githubusercontent.com/EcoClimLab/ForestGEO_dendro/master/data/species%20list/sitespecies.csv?token=AEWDCIJDPYS6SYM54V4UJRTBGIM7W")
bark_allo <- read.csv("https://raw.githubusercontent.com/EcoClimLab/ForestGEO_dendro/master/data_processed/dbh_to_bark_allometries_table.csv?token=AEWDCIOW4CICEKPFXKFR3IDBGJAVA")
load("results/log_core_measurement/BCI_all_env.RData")
# prepare species list ####
species_summary <- data.frame(species.code = species_list$species_code,
family = species_list$family,
latin.name = species_list$latin_name,
accepted.name =species_list$accepted_latin_name_with_authority,
'sites.sampled' = NA,
leaf.type = species_list$leaf_type,
leaf.phenology = species_list$leaf_pheno,
light.requirements = species_list$light_requirements,
bark.allometry = NA
)
## remove duplicates
species_summary <- species_summary[!duplicated(species_summary),]
## add list of sites
species_sites <- data.frame(species_code = unlist(sapply(all_Biol, function(x) as.character(unique(x$species_code)))))
species_sites <- species_sites[-grep("Hansley", row.names(species_sites)),,drop=FALSE] # remove Hansley if is there
species_sites$site <- unlist(sites_abb[gsub("\\d", "", row.names(species_sites))])
species_summary$sites.sampled <- tapply(species_sites$site, species_sites$species_code, paste0, collapse = ", ")[as.character(species_summary$species.code)]
## add bark allomatries
species_summary$bark.allometry <- tapply(ifelse(is.na(species_list$bark_species) | species_list$bark_species == "", "neglected", species_list$bark_latin), species_list$species_code, function(x) paste(unique(x), collapse = ", "))[as.character(species_summary$species.code)] #tapply(paste0(ifelse(is.na(species_list$bark_species) | species_list$bark_species == "", "neglected", paste(species_list$bark_latin, "in ")), species_list$bark_site), species_list$species_code, function(x) paste(unique(x), collapse = ", "))[as.character(species_summary$species.code)]
species_summary$bark.allometry <- gsub(", neglected.*$", "", species_summary$bark.allometry ) # remove repetition of neglected
species_summary$bark.allometry <- gsub(" ,", ",", species_summary$bark.allometry ) # remove space before comma♦
## change bark allometry to allometry ID
species_summary$bark.allometry <- ifelse(species_summary$bark.allometry %in% "neglected", "neglected", bark_allo$ID[match(paste0("$", species_summary$bark.allometry, "$"), bark_allo$species)])
## order by latin name
species_summary <- species_summary[order(species_summary$accepted.name), ]
## remove species that are not sampled in any site
species_summary <- species_summary[!is.na(species_summary$sites.sampled), ]
# change needleleaf to conifer
species_summary$leaf.type <- gsub("needleleaf", "conifer", species_summary$leaf.type)
species_summary$latin.name
## italicize latin names
species_summary$latin.name  <- paste0("$",species_summary$latin.name ,  "$")
species_summary$accepted.name[!species_summary$accepted.name %in% ""] <- sapply(strsplit(species_summary$accepted.name[!species_summary$accepted.name %in% ""] , " "), function(x) {
x[c(1,2)] <- paste0("$", x[c(1,2)] ,  "$")
x <-  paste(x , collapse = " ")
return(x)
})
names(species_summary) <- gsub("\\.|_", " ", names(species_summary))
write.csv(species_summary, "doc/manuscript/tables_figures/species.csv", row.names = F)
View(species_summary)
# load data ####
species_list <- read.csv("https://raw.githubusercontent.com/EcoClimLab/ForestGEO_dendro/master/data/species%20list/sitespecies.csv?token=AEWDCIJDPYS6SYM54V4UJRTBGIM7W", encoding = "UTF-8")
species_list
